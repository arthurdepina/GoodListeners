<!DOCTYPE html>
<html lang="en">
<head>
    <link href="css/style2.css" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlbumName</title>
</head>
<body>
    <div class="container">
        <div class="artist-info">
            <h2 class="artist-name">AlbumName</h2>
            <div class="artist-image">
                <img src="pathToAlbumCover" alt="Album Cover">
            </div>
            <div class="input-container">
                <input type="number" id="albumRating" placeholder="Avalie" min="1" max="5"> <!-- A nota é inserida pelo usuário aqui -->
                <button id="saveRatingButton">Salvar Avaliação</button>
            </div>
            <div id="savedRating"></div>
        </div>
        <div class="scores-container">
            <div class="artist-scores">
                <div class="user-score">
                    <h3>USER SCORE</h3>
                    <p class="score">50</p> <!-- Aqui colocarei depois as notas dadas pelos usuários -->
                    <div class="score-bar">
                        <div class="score-fill user-fill" style="width: 50%;"></div> <!-- No futuro isso será preenchido de acordo com a nota -->
                    </div>
                </div>
            </div>
        </div>

        <div class="details-container">
            <div class="artist-details-info">
                <h3>DETAILS</h3>
                <p class="album-title">
                    AlbumName
                    <span class="album-subtitle"> / album title</span>
                </p>
                <p class="release-date">
                    Released on: ReleaseYear
                    <span class="album-subtitle"> / release date</span>
                </p>
                <p class="genres">
                    AlbumGenre
                    <span class="album-subtitle"> / genre</span>
                </p>
                <p class="length">
                    Length: AlbumLength
                    <span class="album-subtitle"> / album length</span>
                </p>
            </div>
        </div>
    </div>
    <div class="container2">
        <a href="Site1.html" class="return"><button class="btn">VOLTAR</button></a>
    </div>

    <script>
        document.getElementById("saveRatingButton").addEventListener("click", async function() {
            // Obter o valor da avaliação e IDs fictícios de usuário e álbum
            const rating = parseInt(document.getElementById("albumRating").value);
            const albumId = 1;  // Substitua com o ID real do álbum
            const userId = 1;   // Substitua com o ID real do usuário
            
            if (rating >= 1 && rating <= 5) {
                // Dados a serem enviados ao backend
                const reviewData = {
                    userId: userId,
                    albumId: albumId,
                    rating: rating
                };

                try {
                    // Enviar a avaliação ao backend via API
                    const response = await fetch("http://localhost:8080/api/review", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(reviewData)
                    });

                    if (response.ok) {
                        document.getElementById("savedRating").textContent = `Rating: ${rating}`;
                        alert("Avaliação salva com sucesso!");
                    } else {
                        alert("Erro ao salvar a avaliação. Tente novamente.");
                    }
                } catch (error) {
                    console.error("Erro:", error);
                    alert("Erro ao conectar ao servidor.");
                }
            } else {
                alert("Por favor, insira uma nota entre 1 e 5.");
            }
        });
    </script>
</body>
</html>
